#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
示例数据生成器
================
为ExcelGradeProcessor工具创建示例Excel文件
所有数据均为虚构，不包含任何真实个人信息
"""

import pandas as pd
from pathlib import Path

def create_cl_example():
    """创建CL班级名单示例文件"""
    print("创建 CL_Example.xlsx...")
    
    cl_data = {
        '序号': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10],
        '学号': [
            'U202001001', 'U202001002', 'U202001003', 'U202001004', 'U202001005',
            'S202001006', 'S202001007', 'BJ202001008', 'BJ202001009', 'U202001010'
        ],
        '姓名': [
            '张三', '李四', '王五', '赵六', '刘七',
            '陈八', '杨九', '黄十', '周十一', '吴十二'
        ],
        '班级': [
            '计算机201', '计算机201', '计算机202', '计算机202', '计算机203',
            '计算机203', '软件201', '软件201', '软件202', '软件202'
        ],
        '性别': ['男', '女', '男', '男', '女', '男', '女', '男', '女', '男'],
        '联系电话': [
            '138****0001', '139****0002', '136****0003', '137****0004', '135****0005',
            '134****0006', '133****0007', '132****0008', '131****0009', '130****0010'
        ],
        '邮箱': [
            'zhang***@example.com', 'li***@example.com', 'wang***@example.com', 
            'zhao***@example.com', 'liu***@example.com', 'chen***@example.com', 
            'yang***@example.com', 'huang***@example.com', 'zhou***@example.com', 'wu***@example.com'
        ],
        '入学年份': [2020, 2020, 2020, 2020, 2020, 2020, 2020, 2020, 2020, 2020],
        '专业': [
            '计算机科学与技术', '计算机科学与技术', '计算机科学与技术', '计算机科学与技术', '计算机科学与技术',
            '计算机科学与技术', '软件工程', '软件工程', '软件工程', '软件工程'
        ]
    }
    
    df = pd.DataFrame(cl_data)
    # 先创建xlsx文件，然后重命名为xls（保持兼容性）
    df.to_excel('CL_Example.xlsx', index=False, engine='openpyxl')
    import os
    if os.path.exists('CL_Example.xlsx'):
        if os.path.exists('CL_Example.xls'):
            os.remove('CL_Example.xls')
        os.rename('CL_Example.xlsx', 'CL_Example.xls')
    print("  ✅ CL_Example.xls 创建完成")

def create_sa_example():
    """创建SA作业成绩示例文件"""
    print("创建 SA_Example.xlsx...")
    
    sa_data = {
        '序号': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10],
        '学号': [
            'U202001001', 'U202001002', 'U202001003', 'U202001004', 'U202001005',
            'S202001006', 'S202001007', 'BJ202001008', 'BJ202001009', 'U202001010'
        ],
        '姓名': [
            '张三', '李四', '王五', '赵六', '刘七',
            '陈八', '杨九', '黄十', '周十一', '吴十二'
        ],
        '作业标题': [
            '数据结构基础练习', '数据结构基础练习', '数据结构基础练习', '数据结构基础练习', '数据结构基础练习',
            '数据结构基础练习', '数据结构基础练习', '数据结构基础练习', '数据结构基础练习', '数据结构基础练习'
        ],
        '提交时间': [
            '2024-03-15 14:30:00', '2024-03-15 16:20:00', '2024-03-16 09:15:00', 
            '2024-03-16 11:45:00', '2024-03-16 13:20:00', '2024-03-17 08:30:00',
            '2024-03-17 10:15:00', '2024-03-17 15:40:00', '2024-03-18 09:00:00', '2024-03-18 14:20:00'
        ],
        '得分': [85, 92, 78, 88, 95, 82, 76, 90, 87, 91],
        '满分': [100, 100, 100, 100, 100, 100, 100, 100, 100, 100],
        '备注': [
            '完成质量良好', '逻辑清晰', '需要改进算法效率', '代码规范', '优秀作业',
            '基本完成要求', '部分功能缺失', '创新思路', '完成度高', '代码质量佳'
        ]
    }
    
    df = pd.DataFrame(sa_data)
    # 先创建xlsx文件，然后重命名为xls（保持兼容性）
    df.to_excel('SA_Example.xlsx', index=False, engine='openpyxl')
    import os
    if os.path.exists('SA_Example.xlsx'):
        if os.path.exists('SA_Example.xls'):
            os.remove('SA_Example.xls')
        os.rename('SA_Example.xlsx', 'SA_Example.xls')
    print("  ✅ SA_Example.xls 创建完成")

def create_la_example():
    """创建LA实验成绩示例文件"""
    print("创建 LA_Example.xlsx...")
    
    la_data = {
        '序号': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10],
        '学号': [
            'U202001001', 'U202001002', 'U202001003', 'U202001004', 'U202001005',
            'S202001006', 'S202001007', 'BJ202001008', 'BJ202001009', 'U202001010'
        ],
        '姓名': [
            '张三', '李四', '王五', '赵六', '刘七',
            '陈八', '杨九', '黄十', '周十一', '吴十二'
        ],
        '实验名称': [
            '线性表实验', '线性表实验', '线性表实验', '线性表实验', '线性表实验',
            '线性表实验', '线性表实验', '线性表实验', '线性表实验', '线性表实验'
        ],
        '实验时间': [
            '2024-03-20', '2024-03-20', '2024-03-20', '2024-03-20', '2024-03-20',
            '2024-03-27', '2024-03-27', '2024-03-27', '2024-03-27', '2024-03-27'
        ],
        '预习成绩': [8, 9, 7, 8, 9, 8, 7, 9, 8, 9],
        '操作成绩': [42, 45, 38, 41, 47, 40, 36, 44, 43, 46],
        '报告成绩': [35, 38, 32, 36, 39, 34, 31, 37, 36, 38],
        '得分': [85, 92, 77, 85, 95, 82, 74, 90, 87, 93],
        '实验组别': ['A组', 'A组', 'B组', 'B组', 'C组', 'C组', 'D组', 'D组', 'E组', 'E组'],
        '指导教师': [
            '王老师', '王老师', '李老师', '李老师', '张老师',
            '张老师', '刘老师', '刘老师', '陈老师', '陈老师'
        ]
    }
    
    df = pd.DataFrame(la_data)
    # 先创建xlsx文件，然后重命名为xls（保持兼容性）
    df.to_excel('LA_Example.xlsx', index=False, engine='openpyxl')
    import os
    if os.path.exists('LA_Example.xlsx'):
        if os.path.exists('LA_Example.xls'):
            os.remove('LA_Example.xls')
        os.rename('LA_Example.xlsx', 'LA_Example.xls')
    print("  ✅ LA_Example.xls 创建完成")

def create_tl_example():
    """创建TL讨论成绩示例文件"""
    print("创建 TL_Example.xlsx...")
    
    tl_data = {
        '序号': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10],
        '学号': [
            'U202001001', 'U202001002', 'U202001003', 'U202001004', 'U202001005',
            'S202001006', 'S202001007', 'BJ202001008', 'BJ202001009', 'U202001010'
        ],
        '姓名': [
            '张三', '李四', '王五', '赵六', '刘七',
            '陈八', '杨九', '黄十', '周十一', '吴十二'
        ],
        '讨论主题': [
            '算法复杂度分析方法', '算法复杂度分析方法', '算法复杂度分析方法', '算法复杂度分析方法', '算法复杂度分析方法',
            '算法复杂度分析方法', '算法复杂度分析方法', '算法复杂度分析方法', '算法复杂度分析方法', '算法复杂度分析方法'
        ],
        '讨论时间': [
            '2024-03-25 14:00-16:00', '2024-03-25 14:00-16:00', '2024-03-25 14:00-16:00', 
            '2024-03-25 14:00-16:00', '2024-03-25 14:00-16:00', '2024-03-25 14:00-16:00',
            '2024-03-25 14:00-16:00', '2024-03-25 14:00-16:00', '2024-03-25 14:00-16:00', '2024-03-25 14:00-16:00'
        ],
        '参与度': [
            '积极', '积极', '一般', '积极', '非常积极',
            '一般', '较少', '积极', '积极', '非常积极'
        ],
        '发言质量': [
            '良好', '优秀', '一般', '良好', '优秀',
            '一般', '需改进', '良好', '良好', '优秀'
        ],
        '团队协作': [
            '好', '很好', '一般', '好', '很好',
            '一般', '一般', '好', '很好', '很好'
        ],
        '讨论/': [88, 92, 75, 85, 95, 78, 68, 87, 90, 94],
        '小组': ['第1组', '第1组', '第2组', '第2组', '第3组', '第3组', '第4组', '第4组', '第5组', '第5组'],
        '讨论记录': [
            '提出了创新观点', '总结能力强', '参与度有待提高', '逻辑思维清晰', '引导讨论方向',
            '基本完成任务', '发言较少', '善于团队协作', '思路开阔', '组织能力突出'
        ]
    }
    
    df = pd.DataFrame(tl_data)
    df.to_excel('TL_Example.xlsx', index=False)
    print("  ✅ TL_Example.xlsx 创建完成")

def main():
    """主函数 - 创建所有示例文件"""
    print("=== ExcelGradeProcessor 示例数据生成器 ===")
    print("正在创建示例Excel文件...")
    print()
    
    # 创建examples目录
    examples_dir = Path("examples")
    examples_dir.mkdir(exist_ok=True)
    
    # 切换到examples目录
    import os
    os.chdir(examples_dir)
    
    # 创建所有示例文件
    create_cl_example()
    create_sa_example()
    create_la_example()
    create_tl_example()
    
    print()
    print("=== 所有示例文件创建完成 ===")
    print("文件位置: examples/ 目录")
    print()
    print("📁 生成的文件:")
    print("  📄 CL_Example.xls   - 班级名单示例")
    print("  📄 SA_Example.xls   - 作业成绩示例")
    print("  📄 LA_Example.xls   - 实验成绩示例")
    print("  📄 TL_Example.xlsx  - 讨论成绩示例")
    print()
    print("🔧 使用方法:")
    print("  1. 将生成的Excel文件复制到数据目录")
    print("  2. 运行: python grade_summary_tool.py")
    print("  3. 查看生成的汇总表")
    print()
    print("⚠️  注意: 所有数据均为虚构，仅供演示使用")

if __name__ == "__main__":
    main() 